name: samdul
services:
  blog:
    build: ./docker/httpd
    ports:
      - 80
    deploy:
      mode: replicated
      replicas: 1

  load_balancer:
    build: ./docker/nginx
    container_name: blog-lb
    ports:
      - 8949:80
    # depends_on은 서비스의 시작 순서 보장, 서비스를 시작하기 전에 blog_1, blog_2, blog_3 서비스가 반드시 실행되어야 함을 지정
    depends_on:
      - blog
